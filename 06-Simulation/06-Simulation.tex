\section{Simulation}
\label{sec:Simulation}

The simulation of the trackers makes use of the GEANT4 standard physics libraries to describe particle motion through the fields and material of the beam line. The trackers are simulated on a per-fibre basis and arranged into doublet-layer planes (as described in section~\ref{subsec:Trackers}). As particles pass through the fibres scifi hits are generated, containing the energy deposited in the fibre. 

The scifi hits are converted by the MAUS module used to digitise simulated tracker data (MapCppTrackerMCDigitisation) into a number of photo-electrons (NPE) produced in the tracker VLPCs by means of a simple conversion factor. At this point the NPE values are non-integer, and are quantised by rounding down. These NPE values are then ``smeared'' to simulate the detector response (the electron avalanche effect in the VLPCs). The smearing process involves modeling this response as a Gaussian, the mean being given by the quantised NPE value and the width being determined from data. Once the smearing is complete the signal is split into $2^8$ bins to represent the sampling of the 8 bit ADCs. The simulated ADC counts are then used together with the measured calibration of each channel to give a final NPE value.

It is also possible to add noise to the digitisation process through the addition of an extra MAUS module. Noise arises from thermally excited electrons in the VLPCs. The process is stochastic and the rate is controlled by altering the bias voltage on the VLPCs to give 1 NPE in 1.5\% of fibres per particle trigger. The noise is generated as a Poisson distribution. The effect is modelled in the software and used to introduce additional photo-electrons to the simulated signal prior to the quantisation and smearing stage. 

Once the final NPE value has been calculated it is combined with the channel number to form a digit object. The digits are then added to the scifi event and sent on to the reconstruction modules.


% The MAUS framework invokes a beamline module to generate a simulated beam, according to pre-defined user parameters.  A particle incident upon a tracker fibre is stepped through, in accordance with the defined parameters. GEANT4 is invoked in each of these steps in determining the resulting momentum change of the particle and the magnitude of energy  deposited into the fibre.  These values are recorded individually, the current step used in determining where the next step is taken, and recorded before the next step is processed.  After a defined number of particles have been generated and stepped through the experiment the results are collected into a MICE spill and sent to the tracker MC module for processing.  

% A single interaction with a scintillating fibre is simulated by many steps through the material and the figure for any one step is not limited to integer values.  The raw NPE from every step through the fibre is summed and feed into the simulation of noise in the tracker electronics (see section \ref{subsec:Noise}).

%   \subsection{Noise}
%   \label{subsec:Noise}
%   The MC noise simulation consist of two modules, false signal due to thermally excited electrons within the VLPC cassettes and a smearing due to random noise in the tracker electronics.  This is in addition to noise introduced by particle decays handled outside of the tracker MC by the GEANT4 simulation.
%   
%   Simulation of the thermally excited electrons is performed before the smearing simulation.  The dark count is an uncorrelated process that is selected to occur with a magnitude of 1.0 PE in 1.5$\%$ of a data taking window.  Actual rate is determined by the setting of the voltage bias in the VLPC cassettes which as a direct effect on the final signal size.  The process is described as a Poisson distribution.  Studies are under way to understand this effect in each cassette. 
%   
%   The results from the GEANT4 physics simulation and the Poisson dark count simulation are combined and smeared to determine the final NPE signal.  The signal from the GEANT4 simulation can take any value, however, it is unreasonable to expect anything other than an integer number of photons, as such this incoming signal is changed to its nearest integer value. The value is smeared as described by a Gaussian with a sigma derived from a study of carried out in May 2012 of a single station in beam.
%   
%   The smeared result is then fed through a process that simulates the effects of the analogue to digital converters (ADCs).  This process serves to chop the information up into bins of $2^8$ discreet values.  The exact values of these bins is determined from the tracker calibrations and varies with the with the channel placement into the electronics.  Overflows are equivalent to the maximum signal.  